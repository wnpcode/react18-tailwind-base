import{N as B}from"./No_Image_Vertikal.d94c0a7e.js";import{i as H,U as K,p as M,q as b,a as W,e as G,b as J,g as Y,x as Q}from"./index.98d46653.js";import{s as X,C as Z,A as ee}from"./styled.58e262dc.js";import{I as v}from"./index.e1191aef.js";import{r as n,u as te,o as le,P as ae,j as l,F as se,c as i,d as s,i as u,_ as a,f as C,a6 as re,a7 as ie,a8 as ce,a as oe}from"./vendor.9e149c67.js";import{F as P,S as $,C as O}from"./Select.ea97d86c.js";const ne=X("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),ve=()=>{const[T,pe]=n.exports.useState(JSON.parse(H("login_data"))||{}),[x,k]=n.exports.useState({file1:"",file2:"",file3:"",file4:"",file5:""}),[h,I]=n.exports.useState({file1:null,file2:null,file3:null,file4:null,file5:null}),{t:r,i18n:ue}=te(),N=n.exports.useContext(K),S=le();ae();const[e,L]=n.exports.useState({active:!0,stock:0,sku:"",tax:"0"}),[p,R]=n.exports.useState({name:!0,category:!0,type:!0,title:!0,stock:!0,sku:!0,description:!0,hpp:!0,sellingPrice:!0,tax:!0,price:!0}),[f,E]=n.exports.useState({name:"",category:"",type:"",title:"",stock:"",sku:"",description:"",hpp:"",sellingPrice:"",tax:"",price:""});n.exports.useState(""),n.exports.useState("");const[_,F]=n.exports.useState([...Z]),[U,de]=n.exports.useState([...ee]),j=async(t="")=>{try{N.setLoading(!0);let c={};c.name=t;let d=await G(`${J.category.combo[Y()]}`,c);console.log(d.data),F(a.map(d.data,Q))}catch{}finally{N.setLoading(!1)}},o=(t,c)=>{L(d=>({...d,[c]:t}))},q=async()=>{if(!V())return;let t=parseInt(b(a.get(e,"stock"))),c=parseInt(b(a.get(e,"hpp"))),d=parseInt(b(a.get(e,"sellingPrice"))),w=a.get(e,"tax"),g={...e,categoryId:e.category,productType:e.type,companyId:T.companyId,merchantId:T.merchantId,sellingPrice:d,stock:t,buyingPrice:c,tax:w},m=new FormData;const z=JSON.stringify(g),A=new Blob([z],{type:"application/json"});m.append("data",A),a.values(x).map(y=>y&&m.append("files",y));try{N.setLoading(!0);let y=await W("api/v1/admin/products",m);S("/dashboard/product",{replace:!0})}catch(y){console.log(y)}finally{N.setLoading(!1)}},V=()=>{let t={name:!0,category:!0,type:!0,stock:!0,sku:!0,description:!0,hpp:!0,sellingPrice:!0,tax:!0,price:!0},c={name:"",category:"",type:"",stock:"",sku:"",description:"",hpp:"",sellingPrice:"",tax:"",price:""},d=["description","sku"];["PRODUCT_WITHOUT_STOCK","SERVICE"].includes(a.get(e,"type"))&&d.push("stock");let w=a.reject(a.keys(t),g=>d.includes(g));return a.map(w,g=>{a.get(e,g)||(c[g]=`${r(g)} ${r("required")}`,t[g]=!1)}),E(c),R(t),a.reduce(a.values(t),(g,m)=>g&&m,!0)},D=async(t,c)=>{if(t.target.files[0].size>1e6)return oe.error(r("File To Large"));try{I({...h,[c]:URL.createObjectURL(t.target.files[0])}),k({...x,[c]:t.target.files[0]})}catch{}};return n.exports.useEffect(()=>{o(M(e==null?void 0:e.tax,e==null?void 0:e.sellingPrice),"price")},[e==null?void 0:e.sellingPrice,e==null?void 0:e.tax]),n.exports.useEffect(()=>{(async()=>{await j()})()},[]),l(se,{children:i(s.Card,{className:"mt-12 ",children:[i(s.CardBody,{className:"",children:[l("div",{className:"flex flex-row justify-between",children:i("div",{children:[l(s.Typography,{variant:"h5",children:r("product")})," ",l("span",{children:r("addProduct")})]})}),l(s.Typography,{variant:"h5",className:"mt-4",children:r("generalInformation")}),i("div",{className:" flex w-full flex-row flex-wrap bg-white",children:[i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" required text-base font-semibold",children:r("productCategory")}),l(P,{size:"small",error:!p.category&&!a.get(e,"category"),children:l($,{onChange:t=>{o(t.target.value,"category")},value:e==null?void 0:e.category,children:_.map(t=>l(O,{value:t.value,children:t.label},t.value))})})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" required text-base font-semibold",children:r("productType")}),l(P,{size:"small",error:!p.type&&!a.get(e,"type"),children:l($,{onChange:t=>{console.log(t.target.value,"select"),["PRODUCT_WITHOUT_STOCK","SERVICE"].includes(t.target.value)&&o(0,"stock"),o(t.target.value,"type")},value:e==null?void 0:e.type,children:U.map(t=>l(O,{value:t.value,children:t.label},t.value))})})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" required text-base font-semibold",children:r("productName")}),l(s.Input,{color:"blue",type:"text",size:"lg",className:"w-full",onChange:t=>{o(t.target.value,"name")},value:e==null?void 0:e.name,name:"column1",error:!p.name&&!a.get(e,"name")}),l(s.Typography,{className:"text-xs text-red-500",children:!a.get(e,"name")&&f.name})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:`${!["PRODUCT_WITHOUT_STOCK","SERVICE"].includes(a.get(e,"type"))&&"required"} text-base font-semibold`,children:r("stock")}),l(v,{disabled:["PRODUCT_WITHOUT_STOCK","SERVICE"].includes(e==null?void 0:e.type),type:"number",invalid:!p.stock&&!a.get(e,"stock"),value:e==null?void 0:e.stock,onValueChange:t=>o(t,"stock"),error:!p.stock&&!a.get(e,"stock")}),l(s.Typography,{className:"text-xs text-red-500",children:!a.get(e,"stock")&&f.stock})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" text-base font-semibold",children:r("sku")}),l(s.Input,{color:"blue",type:"text",size:"lg",className:"w-full",onChange:t=>{o(t.target.value,"sku")},value:e==null?void 0:e.sku,name:"column1",error:!p.sku&&!a.get(e,"sku")}),l(s.Typography,{className:"text-xs text-red-500",children:!a.get(e,"sku")&&f.sku})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" text-base font-semibold",children:r("description")}),l(s.Input,{color:"blue",type:"text",size:"lg",className:"w-full",onChange:t=>{o(t.target.value,"description")},value:e==null?void 0:e.description,name:"column1",error:!p.description&&!a.get(e,"description")}),l(s.Typography,{className:"text-xs text-red-500",children:!a.get(e,"description")&&f.description})]})]}),l(s.Typography,{variant:"h5",children:r("price")}),i("div",{className:"mt-4 flex w-full flex-row flex-wrap bg-white",children:[i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[i("h3",{className:" required text-base font-semibold",children:[r("hpp")," "]}),l(v,{invalid:!p.hpp&&(!a.get(e,"hpp")||parseInt(a.get(e,"hpp"))==0),value:e==null?void 0:e.hpp,onValueChange:t=>o(t,"hpp")}),l(s.Typography,{className:"text-xs text-red-500",children:(!a.get(e,"hpp")||parseInt(a.get(e,"hpp"))==0)&&f.hpp})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" required text-base font-semibold",children:r("sellingPrice")}),l(v,{invalid:!p.sellingPrice&&(!a.get(e,"sellingPrice")||parseInt(a.get(e,"sellingPrice"))==0),value:e==null?void 0:e.sellingPrice,onValueChange:t=>{o(t,"sellingPrice")}}),l(s.Typography,{className:"text-xs text-red-500",children:(!a.get(e,"sellingPrice")||parseInt(a.get(e,"sellingPrice"))==0)&&f.sellingPrice})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" required text-base font-semibold",children:r("ppn")}),l(v,{invalid:!p.tax&&(!a.get(e,"tax")||parseInt(a.get(e,"tax"))<0),type:"percentage",value:e==null?void 0:e.tax,onValueChange:t=>{o(t,"tax")}}),l(s.Typography,{className:"text-xs text-red-500",children:(!a.get(e,"tax")||parseInt(a.get(e,"tax"))<0)&&f.tax})]}),i("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:[l("h3",{className:" text-base font-semibold",children:r("priceTotal")}),l(v,{disabled:!0,invalid:!p.price&&(!a.get(e,"price")||parseInt(a.get(e,"price"))==0),value:e==null?void 0:e.price,onValueChange:t=>o(t,"price")}),l(s.Typography,{className:"text-xs text-red-500",children:(!a.get(e,"price")||parseInt(a.get(e,"price"))==0)&&f.price})]}),l("div",{className:`flex ${u?"w-1/2":"w-full"}  flex-col px-2 py-2`,children:l(s.Switch,{label:"Aktif",color:"purple",checked:e==null?void 0:e.active,onChange:()=>o(!(e!=null&&e.active),"active")})})]}),l(s.Typography,{variant:"h5",children:r("images")}),l("div",{className:"flex flex-row gap-1",children:a.map(a.toArray("12345"),t=>i(s.Card,{className:"group relative flex aspect-square w-1/5 cursor-pointer items-center justify-center overflow-hidden bg-gray-200",onClick:()=>{document.getElementById(`file${t}`).click()},children:[h[`file${t}`]?l("img",{className:"",src:h[`file${t}`],alt:x[`file${t}`].filename}):l("img",{className:" w-96",src:B,alt:"noImage"}),i("div",{class:"absolute top-0 left-0 flex h-full w-full flex-col items-center justify-center bg-black bg-opacity-0 opacity-0 duration-500 group-hover:h-full group-hover:bg-opacity-80 group-hover:opacity-100",children:[h[`file${t}`]?l(C,{icon:re,className:"fa-3x text-orange-700"}):l(C,{icon:ie,className:"fa-3x text-green-700"}),h[`file${t}`]&&l(C,{onClick:c=>{c.stopPropagation(),I({...h,[`file${t}`]:null}),k({...x,[`file${t}`]:""})},icon:ce,className:"fa-2x absolute top-2 right-2 text-red-500"})]}),l(ne,{id:`file${t}`,type:"file",accept:".jpg,.png,.jpeg",onChange:c=>D(c,`file${t}`)})]},`image-${t}-`+x[`file${t}`].fileName))})]}),i(s.CardFooter,{className:"flex flex-row-reverse gap-1",children:[l(s.Button,{onClick:()=>{q()},className:" rounded-3xl",size:"sm",color:"purple",variant:"gradient",children:r("save")}),l(s.Button,{onClick:()=>S("/dashboard/product"),className:" rounded-3xl",size:"sm",color:"purple",variant:"outlined",children:r("back")})]})]})})};export{ve as default};
